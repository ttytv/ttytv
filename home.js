String.prototype.replaceAll=function(t,e){return this.replace(new RegExp(t,"gm"),e)},String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};var base64EncodeChars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",base64DecodeChars=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);function base64encode(t){for(var e,a,o,n=t.length,c=0,i="";c<n;){if(e=255&t.charCodeAt(c++),c==n){i=(i+=base64EncodeChars.charAt(e>>2))+base64EncodeChars.charAt((3&e)<<4)+"==";break}if(a=t.charCodeAt(c++),c==n){i=(i=(i+=base64EncodeChars.charAt(e>>2))+base64EncodeChars.charAt((3&e)<<4|(240&a)>>4))+base64EncodeChars.charAt((15&a)<<2)+"=";break}o=t.charCodeAt(c++),i=(i=(i=(i+=base64EncodeChars.charAt(e>>2))+base64EncodeChars.charAt((3&e)<<4|(240&a)>>4))+base64EncodeChars.charAt((15&a)<<2|(192&o)>>6))+base64EncodeChars.charAt(63&o)}return i}function base64decode(t){for(var e,a,o,n,c=t.length,i=0,r="";i<c;){for(;e=base64DecodeChars[255&t.charCodeAt(i++)],i<c&&-1==e;);if(-1==e)break;for(;a=base64DecodeChars[255&t.charCodeAt(i++)],i<c&&-1==a;);if(-1==a)break;r+=String.fromCharCode(e<<2|(48&a)>>4);do{if(61==(o=255&t.charCodeAt(i++)))return r}while(o=base64DecodeChars[o],i<c&&-1==o);if(-1==o)break;r+=String.fromCharCode((15&a)<<4|(60&o)>>2);do{if(61==(n=255&t.charCodeAt(i++)))return r}while(n=base64DecodeChars[n],i<c&&-1==n);if(-1==n)break;r+=String.fromCharCode((3&o)<<6|n)}return r}function utf16to8(t){for(var e,a="",o=t.length,n=0;n<o;n++)1<=(e=t.charCodeAt(n))&&e<=127?a+=t.charAt(n):a=2047<e?(a=(a+=String.fromCharCode(224|e>>12&15))+String.fromCharCode(128|e>>6&63))+String.fromCharCode(128|e>>0&63):(a+=String.fromCharCode(192|e>>6&31))+String.fromCharCode(128|e>>0&63);return a}function utf8to16(t){for(var e,a,o,n="",c=t.length,i=0;i<c;)switch((e=t.charCodeAt(i++))>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:n+=t.charAt(i-1);break;case 12:case 13:a=t.charCodeAt(i++),n+=String.fromCharCode((31&e)<<6|63&a);break;case 14:a=t.charCodeAt(i++),o=t.charCodeAt(i++),n+=String.fromCharCode((15&e)<<12|(63&a)<<6|(63&o)<<0)}return n}var MAC={Url:document.URL,Title:document.title,UserAgent:function(){var t=navigator.userAgent;return{mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:-1<t.indexOf("Android")||-1<t.indexOf("Linux"),iPhone:-1<t.indexOf("iPhone")||-1<t.indexOf("Mac"),iPad:-1<t.indexOf("iPad"),trident:-1<t.indexOf("Trident"),presto:-1<t.indexOf("Presto"),webKit:-1<t.indexOf("AppleWebKit"),gecko:-1<t.indexOf("Gecko")&&-1==t.indexOf("KHTML"),weixin:-1<t.indexOf("MicroMessenger")}}(),Copy:function(t){window.clipboardData?window.clipboardData.setData("Text",t):(null==$("#mac_flash_copy").get(0)?$('<div id="mac_flash_copy"></div>'):$("#mac_flash_copy").html(""),$("#mac_flash_copy").html("<embed src="+SitePath+'"images/_clipboard.swf" FlashVars="clipboard='+escape(t)+'" width="0" height="0" type="application/x-shockwave-flash"></embed>')),alert("复制成功")},Home:function(t,e){try{t.style.behavior="url(#default#homepage)",t.setHomePage(e)}catch(t){if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(t){alert("此操作被浏览器拒绝！请手动设置")}Components.classes["@mozilla.org/preferences-service;1"].getService(Components.interfaces.nsIPrefBranch).setCharPref("browser.startup.homepage",e)}}},Fav:function(e,a){try{window.external.addFavorite(e,a)}catch(t){try{window.sidebar.addPanel(a,e,"")}catch(t){alert("加入收藏出错，请使用键盘Ctrl+D进行添加")}}},Open:function(t,e,a){window.open(t,"macopen1","toolbars=0, scrollbars=0, location=0, statusbars=0,menubars=0,resizable=yes,width="+e+",height="+a)},Cookie:{Set:function(t,e,a){var o=new Date;o.setTime(o.getTime()+24*a*60*60*1e3),document.cookie.match(new RegExp("(^| )"+t+"=([^;]*)(;|$)"));document.cookie=t+"="+encodeURIComponent(e)+";path=/;expires="+o.toUTCString()},Get:function(t){t=document.cookie.match(new RegExp("(^| )"+t+"=([^;]*)(;|$)"));if(null!=t)return decodeURIComponent(t[2])},Del:function(t){var e=new Date,a=(e.setTime(e.getTime()-1),this.Get(t));null!=a&&(document.cookie=t+"="+encodeURIComponent(a)+";path=/;expires="+e.toUTCString())}},GoBack:function(){var t=document.domain;0<document.referrer.indexOf(t)?history.back():window.location="http://"+t},Adaptive:function(){"1"==maccms.mob_status&&maccms.url!=maccms.wapurl&&(document.domain==maccms.url&&MAC.UserAgent.mobile?location.href=location.href.replace(maccms.url,maccms.wapurl):document.domain!=maccms.wapurl||MAC.UserAgent.mobile||(location.href=location.href.replace(maccms.wapurl,maccms.url)))},CheckBox:{All:function(t){$("input[name='"+t+"']").each(function(){this.checked=!0})},Other:function(t){$("input[name='"+t+"']").each(function(){this.checked=!this.checked})},Count:function(t){var e=0;return $("input[name='"+t+"']").each(function(){this.checked&&e++}),e},Ids:function(t){var e=[];return $("input[name='"+t+"']").each(function(){this.checked&&e.push(this.value)}),e.join(",")}},Qrcode:function(){$(".mac_qrcode").attr("src","//api.maccms.com/qrcode/?w=150&h=150&url="+MAC.Url)},Image:{Lazyload:{Show:function(){try{$("img.lazy").lazyload()}catch(t){}},Box:function(t){$("img.lazy").lazyload({container:$("#"+t)})}}},Verify:{Init:function(){MAC.Verify.Focus(),MAC.Verify.Click()},Focus:function(){$("body").on("focus",".mac_verify",function(){$(this).removeClass("mac_verify").after(MAC.Verify.Show()),$(this).unbind()})},Click:function(){$("body").on("click","img.mac_verify_img",function(){$(this).attr("src",maccms.path+"/index.php/verify/index.html?")})},Refresh:function(){$(".mac_verify_img").attr("src",maccms.path+"/index.php/verify/index.html?")},Show:function(){return'<img class="mac_verify_img" src="'+maccms.path+'/index.php/verify/index.html?"  title="看不清楚? 换一张！">'}},PageGo:{Init:function(){$(".mac_page_go").click(function(){var t=$(this),e=t.attr("data-url"),a=t.attr("data-total"),t=t.attr("data-sp"),o=$("#page").val();return 0<o&&o<=a&&(e=e.replace(t+"PAGELINK",o).replace("PAGELINK",o),location.href=e),!1})}},Hits:{Init:function(){var $that;0!=$(".mac_hits").length&&($that=$(".mac_hits"),$.ajax({type:"get",url:maccms.path+"/index.php/ajax/hits?mid="+$that.attr("data-mid")+"&id="+$that.attr("data-id")+"&type=update",timeout:5e3,dataType:"json",error:function(){},success:function(json){1==json.code&&$(".mac_hits").each(function(i){$type=$(".mac_hits").eq(i).attr("data-type"),"insert"!=$type&&$("."+$type).html(eval("(json.data."+$type+")"))})}}))}},Score:{Init:function(){0!=$(".mac_score").length&&($("body").on("click",".score_btn",function(t){MAC.Score.Submit()}),$.ajax({type:"post",url:maccms.path+"/index.php/ajax/score?mid="+$(".mac_score").attr("data-mid")+"&id="+$(".mac_score").attr("data-id"),timeout:5e3,error:function(){$(".mac_score").html("评分加载失败")},success:function(t){MAC.Score.View(t)}}))},Submit:function(){var t=$(".mac_score").find("input[name='score']").val();$.ajax({type:"post",url:maccms.path+"/index.php/ajax/score?mid="+$(".mac_score").attr("data-mid")+"&id="+$(".mac_score").attr("data-id")+"&score="+t,timeout:5e3,error:function(){},success:function(t){alert(t.msg),1==t.code&&MAC.Score.View(t)}})},View:function(t){$(".rating"+Math.floor(t.data.score)).attr("checked",!0),$(".score_num").text(t.data.score_num),$(".score_all").text(t.data.score_all),$(".score_pjf").text(t.data.score)}},Star:{Init:function(){0!=$(".mac_star").length&&$(".mac_star").raty({starType:"i",number:5,numberMax:5,half:!0,score:function(){return $(this).attr("data-score")},click:function(t,e){$.ajax({type:"get",url:maccms.path+"/index.php/ajax/score?mid="+$(".mac_star").attr("data-mid")+"&id="+$(".mac_star").attr("data-id")+"&score="+2*t,timeout:5e3,dataType:"json",error:function(){$(".star_box").attr("title","网络异常！")},success:function(t){1==t.status?$(".star_tips").html(t.data.score):$(".star_box").attr("title",t.msg)}})}})}},Digg:{Init:function(){$("body").on("click",".digg_link",function(t){var e=$(this);e.attr("data-id")&&$.ajax({url:maccms.path+"/index.php/ajax/digg.html?mid="+e.attr("data-mid")+"&id="+e.attr("data-id")+"&type="+e.attr("data-type"),cache:!1,dataType:"json",success:function(t){e.addClass("disabled"),1==t.code?"up"==e.attr("data-type")?e.find(".digg_num").html(t.data.up):e.find(".digg_num").html(t.data.down):e.attr("title",t.msg)}})})}},Gbook:{Login:0,Verify:0,Init:function(){$("body").on("keyup",".gbook_content",function(t){MAC.Remaining($(this),200,".gbook_remaining")}),$("body").on("focus",".gbook_content",function(t){1==MAC.Gbook.Login&&1!=MAC.User.IsLogin&&MAC.User.Login()}),$("body").on("click",".gbook_submit",function(t){MAC.Gbook.Submit()})},Show:function(t){$.ajax({type:"post",url:maccms.path+"/index.php/gbook/index?page="+t,timeout:3e3,error:function(){$(".mac_gbook_box").html("留言加载失败，请刷新...")},success:function(t){$(".mac_gbook_box").html(t)}})},Submit:function(){if(""==$(".gbook_content").val())return alert("请输入留言内容"),!1;$.ajax({type:"post",url:maccms.path+"/index.php/gbook/saveData",data:$(".gbook_form").serialize(),success:function(t){alert(t.msg),1==t.code?location.reload():1==MAC.Gbook.Verify&&MAC.Verify.Refresh()}})},Report:function(t){MAC.Pop.Show("#modal-seport",maccms.path+"/index.php/gbook/report?name="+encodeURIComponent(t),function(t){$("body").on("click","#gbook_submit",function(t){MAC.Gbook.Submit()})})}},Search:{Init:function(){$(".mac_search").click(function(){var t=$(this),t=t.attr("data-href")?t.attr("data-href"):maccms.path+"/index.php/vod/search.html";location.href=t+"?wd="+encodeURIComponent($("#wd").val())})},Submit:function(){return!1}},Suggest:{Init:function(o,t,e){try{$(o).autocomplete(maccms.path+"/index.php/ajax/suggest?mid="+t,{inputClass:"mac_input",resultsClass:"mac_results",loadingClass:"mac_loading",width:175,scrollHeight:300,minChars:1,matchSubset:1,cacheLength:10,multiple:!1,matchContains:!0,autoFill:!1,dataType:"json",parse:function(a){var o;return 1==a.code?(o=[],$.each(a.list,function(t,e){e.url=a.url,o[t]={data:e}}),o):{data:""}},formatItem:function(t,e,a){return t.name},formatResult:function(t,e,a){return t.text}}).result(function(t,e,a){$(o).val(e.name),location.href=e.url.replace("mac_wd",encodeURIComponent(e.name))})}catch(t){}}},Ulog:{Init:function(){MAC.Ulog.Set(),MAC.Ulog.Click()},Get:function(){$.ajax({url:maccms.path+"/index.php/user/ajax_ulog/?ac=list",type:"GET",cache:!1,dataType:"json",success:function(t){1==t.code&&$.each(t.list,function(t,e){alert(e.ulog_id)})}})},Set:function(){var t;$(".mac_ulog_set").attr("data-mid")&&(t=$(".mac_ulog_set"),$.get(maccms.path+"/index.php/user/ajax_ulog/?ac=set&mid="+t.attr("data-mid")+"&id="+t.attr("data-id")+"&sid="+t.attr("data-sid")+"&nid="+t.attr("data-nid")+"&type="+t.attr("data-type")))},Click:function(){$("body").on("click","a.mac_ulog",function(t){var e;0==MAC.User.IsLogin?MAC.User.Login():(e=$(this)).attr("data-id")&&$.ajax({url:maccms.path+"/index.php/user/ajax_ulog/?ac=set&mid="+e.attr("data-mid")+"&id="+e.attr("data-id")+"&type="+e.attr("data-type"),cache:!1,dataType:"json",success:function(t){alert(t.msg),1==t.code?e.addClass("disabled"):e.attr("title",t.msg)}})})}},User:{BoxShow:0,IsLogin:0,UserId:"",UserName:"",GroupId:"",GroupName:"",Portrait:"",Init:function(){var t;0<$(".mac_user").length&&$("body").on("click",".mac_user",function(t){MAC.User.Login()}),null!=MAC.Cookie.Get("user_id")&&""!=MAC.Cookie.Get("user_id")&&(t=maccms.path+"/index.php/user",MAC.User.UserId=MAC.Cookie.Get("user_id"),MAC.User.UserName=MAC.Cookie.Get("user_name"),MAC.User.GroupId=MAC.Cookie.Get("group_id"),MAC.User.GroupName=MAC.Cookie.Get("group_name"),MAC.User.Portrait=MAC.Cookie.Get("user_portrait"),MAC.User.IsLogin=1,$(".mac_user").removeClass("mac_user").attr("href",t),$(".user_name").show().find(".name").text(MAC.User.UserName),$(".user_url").show().attr("href",t),$(".user_img").show().attr("src",MAC.User.Portrait))},CheckLogin:function(){0==MAC.User.IsLogin&&MAC.User.Login()},Login:function(){var t="ajax_login";null!=MAC.Cookie.Get("user_id")&&""!=MAC.Cookie.Get("user_id")&&(t="ajax_info"),MAC.Pop.Show("#modal-login",maccms.path+"/index.php/user/"+t,function(t){$("body").on("click","#login_form_submit",function(t){$.ajax({type:"POST",url:maccms.path+"/index.php/user/login",data:$(".mac_login_form").serialize(),success:function(t){1==t.code&&location.reload()}})})})},Logout:function(){$.ajax({type:"post",url:maccms.path+"/index.php/user/logout",success:function(t){alert(t.msg),1==t.code&&location.reload()}})},PopedomCallBack:function(t,e){window.setTimeout(function(){$(window.frames.player_if.document).find(".MacPlayer").html(e)},6e4*t)},BuyPopedom:function(t){var e=$(t);e.attr("data-id")&&confirm("您确认购买此条数据播放权限吗？")&&$.ajax({url:maccms.path+"/index.php/user/ajax_buy_popedom.html?id="+e.attr("data-id")+"&sid="+e.attr("data-sid")+"&nid="+e.attr("data-nid")+"&type="+e.attr("data-type"),cache:!1,dataType:"json",success:function(t){e.addClass("disabled"),alert(t.msg),1==t.code&&top.location.reload()},complete:function(){e.removeClass("disabled")}})}},Pop:{Show:function(e,t,a){$.ajax({type:"post",url:t,timeout:3e3,error:function(){$("body").append(alert("加载失败，请刷新"))},success:function(t){$("body").append(t),$(e).modal("show"),$(".MacPlayer").hide(),$(e).on("hide.bs.modal",function(){$(".MacPlayer").show()}),a(t)}})}},AdsWrap:function(t,e,a){document.writeln('<img width="'+t+'" height="'+e+'" alt="'+a+'" style="background-color: #CCCCCC" />')},Css:function(t){$("<link>").attr({rel:"stylesheet",type:"text/css",href:t}).appendTo("head")},Js:function(t){$.getScript(t,function(t,e){})},Desktop:function(t){location.href=maccms.path+"/index.php/ajax/desktop?name="+encodeURI(t)+"&url="+encodeURI(location.href)},Timming:function(){},Error:function(t,e,a){},AddEm:function(t,e){var a=$(t).val();$(t).val(a+"[em:"+e+"]")},Remaining:function(t,e,a){e-=$(t).val().length;e<0&&(e=0,$(t).val($(t).val().substr(0,200))),$(a).text(e)},Comment:{Login:0,Verify:0,Init:function(){$("body").on("click",".comment_face_box img",function(t){var e=$(this).parent().parent().parent().find(".comment_content");MAC.AddEm(e,$(this).attr("data-id"))}),$("body").on("click",".comment_face_panel",function(t){$(this).parent().find(".comment_face_box").toggle()}),$("body").on("keyup",".comment_content",function(t){var e=$(this).parent().parent().parent().parent().find(".comment_remaining");MAC.Remaining($(this),200,e)}),$("body").on("focus",".comment_content",function(t){1==MAC.Comment.Login&&1!=MAC.User.IsLogin&&MAC.User.Login()}),$("body").on("click",".comment_report",function(t){var e=$(this);$(this).attr("data-id")&&$.ajax({url:maccms.path+"/index.php/comment/report.html?id="+e.attr("data-id"),cache:!1,dataType:"json",success:function(t){e.addClass("disabled"),alert(t.msg),t.code}})}),$("body").on("click",".comment_reply",function(t){var e=$(this);if(e.attr("data-id")){var a=e.html();if($(".comment_reply_form").remove(),"取消回复"==a)return e.html("回复"),!1;"回复"==a&&$(".comment_reply").html("回复");a=$(".comment_form").prop("outerHTML"),a=$(a);a.addClass("comment_reply_form"),a.find('input[name="comment_pid"]').val(e.attr("data-id")),e.parent().after(a),e.html("取消回复")}}),$("body").on("click",".comment_submit",function(t){var e=$(this);MAC.Comment.Submit(e)})},Show:function(t){0<$(".mac_comment").length&&$.ajax({type:"get",url:maccms.path+"/index.php/comment/ajax.html?rid="+$(".mac_comment").attr("data-id")+"&mid="+$(".mac_comment").attr("data-mid")+"&page="+t,timeout:5e3,error:function(){$(".mac_comment").html("评论加载失败，请刷新...")},success:function(t){$(".mac_comment").html(t)}})},Reply:function(t){},Submit:function(t){t=t.parents("form");return""==$(t).find(".comment_content").val()?(alert("请输入您的评论！"),!1):""==$(".mac_comment").attr("data-mid")?(alert("模块mid错误！"),!1):""==$(".mac_comment").attr("data-id")?(alert("关联id错误！"),!1):void $.ajax({type:"post",url:maccms.path+"/index.php/comment/saveData",data:$(t).serialize()+"&comment_mid="+$(".mac_comment").attr("data-mid")+"&comment_rid="+$(".mac_comment").attr("data-id"),success:function(t){alert(t.msg),1==t.code?MAC.Comment.Show(1):1==MAC.Comment.Verify&&MAC.Verify.Refresh()}})}}};$(function(){MAC.Adaptive(),MAC.Verify.Init(),MAC.PageGo.Init(),MAC.User.Init(),MAC.Digg.Init(),MAC.Score.Init(),MAC.Star.Init(),MAC.Hits.Init(),MAC.Ulog.Init(),MAC.Suggest.Init(".mac_wd",1,""),MAC.Timming()});